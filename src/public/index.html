<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Note Taking App</title>
</head>
<style>
    body{
        /*----->HOW TO CENTER A DIV<-----*/

        display:flex; /*horizontal-- youtube:css flexbox or w3school*/ 
        flex-direction:column;/*vertical set up elements*/
        align-items:center; /*center horizontally, To just center the text inside an element, use text-align: center*/
        justify-content: center; /*center vertically*/
        height: 100vh; /*100% of the viewport height*/
        overflow: hidden; /*hide the scroll bar*/
        margin: 0;/*WHY?*/
    }
    .main{display: flex;}
    button {justify-content: space-between;}

</style>

<body>
    <!-- TODO: CREATE FRONTEND DEMO -->
    <div class="main">
        <form method="POST" action="/api/notes">
            <label for="demo"></label>
            <input type="text" id="box1" name="demo" style="height: 5rem; width: 20rem">
        </form>
    </div>
    <div class="goodButtons">
    <button input="button" id="b1" style="color:green">Post</button>
    <button input="button" id="b2" style="color: yellow">Update</button>
    <button input="button" id="b3" style="color:red">Delete</button>
    </div>
    <br>

    <div id="sleeperDiv" style="visibility: hidden;"></div>

    <script>
        console.log("testing...");
        //<-- FRONTEND JS -->
        let content = document.getElementById('box1');
        let b1 = document.getElementById('b1');
        let b2 = document.getElementById('b2');
        let b3 = document.getElementById('b3');
        
        function sendPost(e) {
            const data = { username: content.value };
            var successFlag = false;

            //send request to endpoint (api)
            fetch('/api/notes',{
                method: 'POST', // or 'PUT'
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            })
                .then((response) => response.json())
                .then((data) => {
                    console.log('Success:', data);
                    successFlag = True;
                    //create message to user
                })
                .catch((error) => {
                    console.error('Error:', error);
                }).finally(() => { /*study*/
                    if (successFlag) {
                        console.log("success");
                        const hidden = document.getElementById('hiddenBox');
                        hidden.removeAttribute("style");

                        const newDiv = document.createElement("div");
                        const newContent = document.createTextNode(content.value);

                        newDiv.appendChild(newContent);
                        document.body.insertBefore(newDiv, hidden);
                    }
                    else {
                        console.log("fail");
                    }
                });
            e.preventDefault();
        }

        function sendUpdate(e) {

            e.preventDefault();
        }

        function deletePost(e) {

            e.preventDefault();
        }

        b1.addEventListener('click', sendPost);
        b2.addEventListener('click', sendUpdate);
        b3.addEventListener('click', deletePost);
    </script>
</body>
</html>
